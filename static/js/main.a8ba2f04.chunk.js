(this.webpackJsonpphotowall=this.webpackJsonpphotowall||[]).push([[0],{101:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"startAddingPost",(function(){return A})),n.d(a,"startLoadingPost",(function(){return k})),n.d(a,"startRemovingPost",(function(){return C})),n.d(a,"startAddingComment",(function(){return L})),n.d(a,"startLoadingComments",(function(){return T})),n.d(a,"loadComments",(function(){return I})),n.d(a,"removePost",(function(){return x})),n.d(a,"addPost",(function(){return M})),n.d(a,"addComment",(function(){return R})),n.d(a,"loadPosts",(function(){return V}));var r=n(1),o=n.n(r),c=n(89),i=n.n(c),s=(n(101),n(8)),u=n(14),l=n(29),m=n(15),d=n(53),p=[];var f=Object(u.c)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REMOVE_POST":return[].concat(Object(l.a)(e.slice(0,t.index)),Object(l.a)(e.slice(t.index+1)));case"ADD_POST":return[].concat(Object(l.a)(e),[t.post]);case"LOAD_POSTS":return t.posts;default:return e}return e},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COMMENT":return e[t.postId]?Object(d.a)({},e,Object(m.a)({},t.postId,[].concat(Object(l.a)(e[t.postId]),[t.comment]))):Object(d.a)({},e,Object(m.a)({},t.postId,[t.comment]));case"LOAD_COMMENTS":return t.comments;default:return e}return e}}),h=n(42),b=n(16),E=n(17),v=n(18),O=n(19);var g=function(e){var t=e.post;return o.a.createElement("figure",{className:"figure"},o.a.createElement(s.b,{to:"/single/".concat(t.id)},o.a.createElement("img",{className:"photo",src:t.imageLink,alt:t.description})),o.a.createElement("figcaption",null,o.a.createElement("p",null,t.description)),o.a.createElement("div",{className:"button-container"},o.a.createElement("button",{onClick:function(){e.startRemovingPost(e.index,t.id),e.history.push("/")}},"Remove"),o.a.createElement(s.b,{className:"button",to:"/single/".concat(t.id)},o.a.createElement("div",{className:"comment-count"},o.a.createElement("div",{className:"speech-bubble"}),e.comments[t.id]?e.comments[t.id].length:0))))};var j=function(e){return o.a.createElement("div",null,o.a.createElement(s.b,{className:"addIcon",to:"/AddPhoto"}),o.a.createElement("div",{className:"photo-grid"},e.posts.sort((function(e,t){return t.id-e.id})).map((function(t,n){return o.a.createElement(g,Object.assign({key:n,post:t},e,{index:n}))}))))},y=n(25),N=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(){var e;return Object(b.a)(this,n),(e=t.call(this)).handleSubmit=e.handleSubmit.bind(Object(y.a)(e)),e}return Object(E.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=e.target.elements.link.value,n=e.target.elements.description.value,a={id:Number(new Date),description:n,imageLink:t};n&&t&&(this.props.startAddingPost(a),this.props.onHistory.push("/"))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",{className:"font-face"},o.a.createElement(s.b,{to:"/"},"Photowall")),o.a.createElement("div",{className:"form"},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("input",{type:"text",placeholder:"Link",name:"link"}),o.a.createElement("input",{type:"text",placeholder:"Description",name:"description"}),o.a.createElement("button",null,"Post"))))}}]),n}(r.Component),S=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(){var e;return Object(b.a)(this,n),(e=t.call(this)).handleSubmit=e.handleSubmit.bind(Object(y.a)(e)),e}return Object(E.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=e.target.elements.comment.value;this.props.startAddingComment(t,this.props.id),e.target.elements.comment.value=""}},{key:"render",value:function(){return o.a.createElement("div",{className:"comment"},this.props.comments.map((function(e,t){return o.a.createElement("p",{key:t},e)})),o.a.createElement("form",{className:"comment-form",onSubmit:this.handleSubmit},o.a.createElement("input",{type:"text",placeholder:"Add comment here, then press enter",name:"comment"}),o.a.createElement("input",{type:"submit",hidden:!0})))}}]),n}(r.Component),D=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(E.a)(n,[{key:"render",value:function(){var e=this.props,t=e.match,n=e.posts,a=Number(t.params.id),r=n.find((function(e){return e.id===a})),c=this.props.comments[t.params.id]||[],i=this.props.posts.findIndex((function(e){return e.id===a}));return!0===this.props.loading?o.a.createElement("div",null,o.a.createElement("h1",null," ...loading ")):r?o.a.createElement("div",null,o.a.createElement("h1",{className:"font-face"},o.a.createElement(s.b,{to:"/"},"Photowall")),o.a.createElement("div",{className:"single-photo"},o.a.createElement(g,Object.assign({post:r},this.props,{index:i})),o.a.createElement(S,{startAddingComment:this.props.startAddingComment,comments:c,id:a}))):o.a.createElement("h2",null,o.a.createElement(s.b,{to:"/"},"...Sorry, no post found"))}}]),n}(r.Component),w=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0},e}return Object(E.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.startLoadingPost().then((function(){e.setState({loading:!1})})),this.props.startLoadingComments()}},{key:"render",value:function(){var e=this;return console.log(this.props),o.a.createElement("div",null,o.a.createElement(s.c,{exact:!0,path:"/",render:function(){return o.a.createElement("div",null,o.a.createElement("h1",{className:"font-face"},o.a.createElement(s.b,{to:"/"},"Photowall")),o.a.createElement(j,Object.assign({},e.props,{onNavigate:e.navigate})))}}),o.a.createElement(s.c,{path:"/AddPhoto",render:function(t){var n=t.history;return o.a.createElement(N,Object.assign({},e.props,{onHistory:n}))}}),o.a.createElement(s.c,{path:"/single/:id",render:function(t){return o.a.createElement(D,Object.assign({loading:e.state.loading},e.props,t))}}))}}]),n}(r.Component),P=n(54);P.initializeApp({apiKey:"AIzaSyAeEXnVPgnpxrlRDUBhTHNVZLpjU2qNang",authDomain:"photowall-d9e8b.firebaseapp.com",databaseURL:"https://photowall-d9e8b.firebaseio.com",projectId:"photowall-d9e8b",storageBucket:"photowall-d9e8b.appspot.com",messagingSenderId:"72736867679",appId:"1:72736867679:web:69d2978783b359f61262ea"});var _=P.database();function A(e){return function(t){return _.ref("posts").update(Object(m.a)({},e.id,e)).then((function(){t(M(e))}))}}function k(){return function(e){return _.ref("posts").once("value").then((function(t){var n=[];t.forEach((function(e){n.push(e.val())})),e(V(n))})).catch((function(e){console.log(e)}))}}function C(e,t){var n,a=(n={},Object(m.a)(n,"posts/".concat(t),null),Object(m.a)(n,"comments/".concat(t),null),n);return function(t){return _.ref().update(a).then((function(){t(x(e))})).catch((function(e){console.log(e)}))}}function L(e,t){return function(n){return _.ref("comments/"+t).push(e).then((function(){n(R(e,t))})).catch((function(e){console.log(e)}))}}function T(){return function(e){return _.ref("comments").once("value").then((function(t){var n={};t.forEach((function(e){n[e.key]=Object.values(e.val())})),e(I(n))}))}}function I(e){return{type:"LOAD_COMMENTS",comments:e}}function x(e){return{type:"REMOVE_POST",index:e}}function M(e){return{type:"ADD_POST",post:e}}function R(e,t){return{type:"ADD_COMMENT",comment:e,postId:t}}function V(e){return{type:"LOAD_POSTS",posts:e}}var U=n(92);var X=Object(U.a)(Object(h.b)((function(e){return{posts:e.posts,comments:e.comments}}),(function(e){return Object(u.b)(a,e)}))(w)),B=n(95),H=n.n(B),z=Object(u.d)(f,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(u.a)(H.a));i.a.render(o.a.createElement(h.a,{store:z},o.a.createElement(s.a,{basename:window.location.pathname||""},o.a.createElement(X,null))),document.getElementById("root"))},96:function(e,t,n){e.exports=n(171)}},[[96,1,2]]]);
//# sourceMappingURL=main.a8ba2f04.chunk.js.map